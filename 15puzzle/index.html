<!DOCTYPE html>
<!-- saved from url=(0040)https://magnets.jp/demo/inagaki20170519/ -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title></title>
    <link href="./magnets.jp_files/base.css" type="text/css" rel="stylesheet" media="all">
</head>
<body>

<ul id="puzzle"></ul>

<script src="./magnets.jp_files/jquery.min.js.ダウンロード"></script>
<script type="text/javascript">

    var panel = [];  //ランダムに並び替える用の配列
    var starX = 300;  //★パネルの初期left値
    var starY = 300;  //★パネルの初期right値
    var clear = 0;  //クリアー判定用

    //クリアー判定
    function gameClear(){
        for(i=0; i<15; i++) {
            var x = parseInt($('#'+i).css('left'))/100;
            var y = parseInt($('#'+i).css('top'))/100;
            var clearX = i%4;
            var clearY = Math.floor(i/4)
            if((clearX == x)&&(clearY == y)) {  //0～15のパネルが正しい位置にあるかを確認
                clear ++;  //OKならclearに+1
            }
        }
        if(15 <= clear) {  //15枚のパネルが全て正しい位置にあれば
            alert("クリアー！");
        } else {
            clear = 0;
        }
    }

    $(function(){
        //ランダム配置するパネルの枚数分の番号を配列に格納
        for(i=0; i<15; i++) {
            panel.push(i)
        };
        //配列の中身0~14をランダムに並び替え
        /*panel.sort(function() {
            return Math.random() - Math.random();
        })
        panel.push(15);*/

        //15枚のパネルの生成
        for(i=0; i<15; i++) {
            $("#puzzle").append("<li id='"+panel[i]+"'><img src='magnets.jp_files/"+panel[i]+".png'></li>");
            var x = i%4*100;  //パネルのleft値
            var y =  Math.floor(i/4)*100;  //パネルのtop値
            $("#"+panel[i]).css({'left':x, 'top':y});  //生成したパネルの位置指定
        }
        $("#puzzle").append("<li id='15'><img src='magnets.jp_files/15.png'></li>");  //★パネル生成
        $("#15").css({'left':starX, 'top':starY});  //★パネルの位置指定

        //パネルクリック時の処理
        $('#puzzle li').on('click', function() {
            var idX = parseInt($(this).css('left'));  //クリックしたパネルのleft値を保存
            var idY = parseInt($(this).css('top'));  //クリックしたパネルのtop値を保存
            if( ((idX==starX)&&((idY==starY-100)||(idY==starY+100))) || ((idY==starY)&&((idX==starX-100)||(idX==starX+100))) ) {  //クリックしたパネルが★と隣接していれば…
                $(this).css({'left':starX, 'top':starY});  //クリックしたパネルを★の位置に移動
                $("#15").css({'left':idX, 'top':idY});  //★をクリックしたパネルの位置に移動
                starX = idX;  //変数に保存していた★マークのleft値を現在の値に更新
                starY = idY;  //変数に保存していた★マークのtop値を現在の値に更新
            }
            gameClear();  //クリアー判定の関数を実行
        });

    });

</script>


</body></html>